FASTQ files were first generated using bcl2fastq (v. 2.20.0), and subsequently processed by a python script to add the corresponding UMI reads to the FASTQ read headers. As described in The Analysis Guide for NuGEN Ovation RRBS Methyl-Seq (https://github.com/nugentechnologies/NuMetRRBS), the FASTQ files were then trimmed using Trim Galore! (v. 0.6.4) with default settings and further processed using the trimRRBSdiversityAdaptCustomers.py script to remove diversity adapter sequences. Methylation coverage was then extracted using Bismark by aligning reads to the GRCh38 assembly. Here, the dedplucate_bismark step was performed using the --barcode option to deduplicate reads based on the UMIs.  Furthermore, the --ignore 3 parameter was used in the methylation extraction step to disregard restriction enzyme sites. 

The resulting methylation coverage files were then analysed using the BiSeq R package (v. 1.36.0). In brief, all 55 sperm DNA samples were split into 2 groups, low-TADS (TADS < 10, n = 30) and high-TADS (TADS > 40, n = 25). As described in the BiSeq user guide (https://bioconductor.org/packages/release/bioc/vignettes/BiSeq/inst/doc/BiSeq.pdf), clusters of CpGs along the genome were defined according to the following criteria: a minimum of 20 CpG sites with coverage of >80 % in both TADS-groups and a maximum distance of 100 bp. The methylation level was then smoothed within each CpG cluster, weighted by the coverage of the inidividual CpGs. To reduce bias due to unusually high coverage, the coverage for each CpG was limited to the 90% quantile. Subesquently, the statistical tests employed by BiSeq were used to detect CpG clusters and individual CpG sites that were differentially methylated between the two TADS-groups in a false-discovery rate (FDR)-controlled manner. Furthermore, the significant CpG sites were used to construct differentially methylated regions (DMRs), which marks regions of siginicant hyper- or hypomethylation within each TADS-group. Finally, CpGs were annotated according to their genomic context, i.e. present in a promoter (within 3kb of the TSS), exon, intron, or as a distal intergenic CpG.
